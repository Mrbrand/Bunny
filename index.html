<!DOCTYPE html>
<html>
	<head>
		<title>Neonic</title> 
		
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		
		<link rel="stylesheet" type="text/css" href="style.css">
		
		<script language="JavaScript" type="text/javascript" src="javascript/mustache.js"></script>	
		<script language="JavaScript" type="text/javascript" src="javascript/carbon.js"></script>
		<script language="JavaScript" type="text/javascript" src="javascript/jquery-2.1.3.min.js"></script> 
		<script language="JavaScript" type="text/javascript" src="javascript/tinysort.js"></script>
	</head>
	
	<body>
	
	
	
		<!--START PAGE -------------->
			<div id="start" class="page" style="display:block;">
			  
			<div id="header">
				<div class="menu-title">Root</div>
			</div> <!--end header-->
			
			<!--Sub-meny-->
			<div class="submenu">
				<button class="back-button">Back</button>
				<button class="new-button">New</button>
			</div><!-- end controls-->
			
			<!-- Projektlista -->
			<div id="items">
				<input class="search" placeholder="Search"  style="display:none;"/>
				<div id="list"></div><!-- här hamnar alla items-->
			</div><!-- end items--> 
			
		</div><!-- end page-->

		
		
		
		<!-- EDIT item ---------------------------------------------------------------------->
		<div id="edit" class="page">
			
			<div id="header">
				<div class="menu-title">-item-title-</div>
			</div> <!--end header-->
			
			<!--Sub-meny-->
			<div class="submenu">
				<button class="back-button">Cancel</button>
				<button class="submit-edit-item-form" style="width:70px; float:right;"><img src="img/save.png" /></button>
				<button class="delete-button" style="width:70px; float:right;"><img src="img/delete2.png" /></button>
				<button class="finish-button" style="width:70px; float:right;"><img src="img/finish.gif" /></button>
				<br/><br/>
			</div><!-- end controls--> 
			
			<form id="edit-item-form">
				<input class="item-title" name="title" type="text" style="margin-bottom:5px;height:40px;"/><br/>
				item_id:<input class="item-id" name="id" type="text" readonly="readonly" style="width:40px;"/> 
				Parent_id:<input class="item-parent-id" name="parent_id" type="text" style="width:40px;margin-bottom:5px;"/><br/>
				
				<select class="item-prio" name="prio" style="margin-bottom:5px;height:40px;">
					<option value="1">Prio 1</option>
					<option value="2">Prio 2</option>
					<option value="3">Prio 3</option>
					<option value="4">Prio 4</option>
					<option value="5">Prio 5</option>
				</select><br/>
				
				<select class="item-type" name="type" style="margin-bottom:5px;height:40px;">
					<option value="1">Koda</option>
					<option value="2">Skissa</option>
					<option value="3">Lösa</option>
					<option value="4">Idé</option>
					<option value="5">Problem</option>
					<option value="6">Todo</option>
					<option value="7">Projekt</option> 
					<option value="8">Sida</option> 
					<option value="100">Dokument</option>  
				</select><br/>
				
				<select class="item-size" name="size" style="margin-bottom:5px;height:40px;">
					<option value="0">--Set size--</option>
					<option value="1">Quick</option>
					<option value="2">Small</option>
					<option value="3">Medium</option>
					<option value="4">Large</option>
					<option value="5">XLarge</option>
				</select><br/>
				
				<textarea class="item-notes" name="notes" rows="5" placeholder="Notes"></textarea>
				<br/><br/><br/><br/><br/>
			</form>
		</div><!--edit-item--> 

		
		
		
		
		<!-- NEW item--------------------------------------------------------------------------->
		<div id="new" class="page">
			
			<div id="header">
				<div class="menu-title">-new item-</div>
			</div> <!--end header-->
			
			<!--Sub-meny-->
			<div class="submenu">
				<button class="cancel-button">Cancel</button>
				<button class="btn-submit-new-item">Add</button>
			</div><!-- end controls--> 
			
			
			
			<form id="new-item-form">
				<textarea  id="new-item-title" name="title" placeholder="Title" rows="1"></textarea><br/>
			
				<select id="new-item-prio" name="prio" style="margin-bottom:5px;height:40px;">
					<option value="1">Prio 1</option> 
					<option value="2">Prio 2</option> 
					<option value="3" selected="selected">Prio 3</option> 
					<option value="4">Prio 4</option> 
					<option value="5">Prio 5</option>
				</select><br/>
				
				<select id="new-item-type" name="type" style="margin-bottom:5px;height:40px;">
					<option value="1">Koda</option>
					<option value="2">Skissa</option>
					<option value="3">Lösa</option>
					<option value="4">Idé</option>
					<option value="5">Problem</option>
					<option value="6">Todo</option>
					<option value="7">Projekt</option> 
					<option value="8">Sida</option> 
					<option value="100">Dokument</option> 
				</select>
				
				 <select id="new-item-size" name="size" style="margin-bottom:5px;height:40px;">
					<option value="0" selected>--Set size--</option>
					<option value="1">Quick</option>
					<option value="2">Small</option>
					<option value="3">Medium</option>
					<option value="4">Large</option>
					<option value="5">XLarge</option>
				</select><br/>
				
				<textarea id="new-item-notes" name="notes" placeholder="Notes" rows="5"></textarea>
				
				<input type="hidden" name="parent_id" id="new-parent-id" value="0"/>
				<input type="hidden" name="status" value="open" placeholder="Status" style="margin-bottom:5px;"/>
				
			</form>
			<br/><br/><br/><br/><br/><br/><br/>
		</div><!-- end new-item--> 
	
	</body>
</html>



<!-- Mustache template -->
<script id="item_template" type="text/template">
	<div class="subitem project">
						
		<div class="subitem-left quick_edit_item">
			<img class="prio-icon" src="img/prio{{prio}}.png"/>
			<img class="type-icon" style="margin:4px 3px;" src="img/type{{type}}.png"/>
			<img class="type-icon" style="margin:0;" src="img/size{{size}}.png"/>
		</div>
		
		<div class="subitem-center">
			<div class="title" style="">{{title}}</div>
			<div class="next_action_div" style="float:left;">
				{{#notes}}<span class="notes">{{notes}}</span>{{/notes}}
				{{#subitems}}
					<img style="margin:4px 0px 4px 5px;height:10px;vertical-align: text-top;" src="img/type{{type}}.png"/>
					<span class="next_action">{{title}}</span><br/>  
				{{/subitems}}
			</div>
		</div><!-- end subitem-center -->
		 
		<div style="clear:both;"></div>
		
		<span class="item_id" style="display:none;">{{id}}</span>
		<span class="prio" style="display:none;">{{prio}}</span>
		<span class="type" style="display:none;">{{type}}</span>
	
	</div><!-- end subitem  -->
</script>	
	
	
	
	
	
<!-- Navigerings script -->	
<script>
	
	// Uppstart
	var current = {id:0, parent_id:0, title:"Alla"};
	itemList.init("key");
	view_item(0);

	// .subitem-left (edit)
	$(document).on('click', ".subitem-left", function() {
		
		var current_id = $(this).parent().find(".item_id").text();
		current = itemList.get_item(current_id);
        //console.log(current.id);
		$(".menu-title").html("Edit: "+current.title);
		
        $("input.item-id").val(current_id);
        $("input.item-title").val(current.title);
        $("textarea.item-notes").val(current.notes);
		$(".item-prio").val(current.prio);
        $(".item-type").val(current.type);
        $(".item-size").val(current.size);
        $("input.item-parent-id").val(current.parent_id);
		
		/*$("input.item-category").val(current.category);
        $("input.item-create-date").val(current.date_create);
        $("input.item-finish-date").val(current.date_finished);*/
				
		$(".page").hide();
		$("#edit").show();
    });
    
	
	// .subitem-center
	$(document).on('click', ".subitem-center", function() {
		var current_id = $(this).parent().find(".item_id").text();
		current = itemList.get_item(current_id);
		console.log(current.id);
		
		if(current.id == 0) $(".back-button").hide(); 
		else $(".back-button").show();
				
		$(".menu-title").html(current.title);
		itemList.refresh($(this).parent().find(".item_id").text());
    });
    
	// .new-button
	$(document).on('click', ".new-button", function() {
 
		$(".menu-title").html("New: "+current.title);
        $("input.item-id").val(current.id);
        $("#new-item-title").val("");
        $("#new-item-prio").val("2");
       // $("#new-item-type").val("1");
        $("#new-item-notes").val("");
        $("#new-item-size").val("0");
        $("#new-parent-id").val(current.id);
		
		$(".page").hide();
		$("#new").show();
		
		console.log("hej");
    });
	
	// .btn-submit-new-item
	$(document).on('click', ".btn-submit-new-item", function() {
        itemList.add_from_form("#new-item-form");
		view_item(current.id);
    });
	
	// .btn-submit-edit-item
	$(document).on('click', ".submit-edit-item-form", function() {
        itemList.edit_from_form("#edit-item-form");
		view_item(current.parent_id);
		
    });
	
	
	// .back-button
    $(document).on('click', ".back-button", function() {
		view_item(current.parent_id);
    });

	// .cancel-button
    $(document).on('click', ".cancel-button", function() {
        view_item(current.id);
    });
	
	// .delete-button
    $(document).on('click', ".delete-button", function() {
		
		if (confirm('Ta bort "'+current.title+'"?')==true) {
            itemList.remove_item(current.id);
			view_item(current.parent_id);
		}
    });
	
	function view_item (id) {
		current = itemList.get_item(id);
		itemList.refresh(id);
		$(".menu-title").html(current.title);
		
		if(current.id == 0) $("#start>.submenu>.back-button").hide(); 
		else $("#start>.submenu>.back-button").show();
	
		$(".page").hide();
		$("#start").show();
	}
	
</script>
